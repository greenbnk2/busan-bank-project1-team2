<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§ˆì´í˜ì´ì§€ ë¹„ë°€ë²ˆí˜¸ë³€ê²½</title>
    <!--
        ë‚ ì§œ : 2025/11/25
        ì´ë¦„ : ì´ì¤€ìš°
        ë‚´ìš© : ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ page ìƒì„±
     -->
</head>
<body>
<div th:replace="~{layouts/header.html}"></div>

<main>
    <div class="form-card">
        <form>
            <!-- í…Œì´ë¸” ê°ì‹¸ê¸° -->
            <div>
                <table class="table-wrap">
                    <tr>
                        <td><h2 style="margin-bottom: 15px; text-align: center">ğŸ”’ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</h2></td>
                    </tr>
                    <tr>
                        <td style="padding-left: 5px; color: #16a34a">âœ” ì•ˆì „í•œ ì„œë¹„ìŠ¤ ì´ìš©ì„ ìœ„í•´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ê°•í™”í•´ ì£¼ì„¸ìš”</td>
                    </tr>
                    <tr>
                        <td style="padding-left: 5px; color: #16a34a">âœ” ë‹¤ë¥¸ ê³„ì •ê³¼ ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ë¹„ë°€ë²ˆí˜¸ë¥¼ ì‚¬ìš©í•´ ì£¼ì„¸ìš”</td>
                    </tr>
                    <tr>
                        <td style="padding-left: 5px; color: #16a34a">âœ” ì´ì „ì— ì‚¬ìš©í•œ ë¹„ë°€ë²ˆí˜¸ëŠ” í”¼í•˜ëŠ” ê²ƒì´ ì•ˆì „í•©ë‹ˆë‹¤</td>
                    </tr>
                    <tr class="field-row">
                        <td class="field-label">í˜„ì¬ ë¹„ë°€ë²ˆí˜¸</td>
                        <td>
                            <div class="pw-wrapper">
                                <input type="password" class="input" id="currentPw" name="currentPw" style="width: 280px">
                                <button type="button" class="pw-toggle" data-target="currentPw"
                                        aria-label="í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ ë³´ê¸° ì „í™˜">ğŸ‘
                                </button>
                            </div>
                            <div id="currentPwHint" class="hint">&nbsp;</div>
                        </td>
                    </tr>
                    <tr class="field-row">
                        <td class="field-label">ìƒˆ ë¹„ë°€ë²ˆí˜¸</td>
                        <td>
                            <div class="pw-wrapper">
                                <input type="password" class="input" id="newPw" name="newPw" style="width: 280px">
                                <button type="button" class="pw-toggle" data-target="newPw"
                                        aria-label="ìƒˆ ë¹„ë°€ë²ˆí˜¸ ë³´ê¸° ì „í™˜">ğŸ‘
                                </button>
                            </div>
                            <div id="pwHint" class="hint"></div>
                        </td>
                    </tr>
                    <tr class="field-row">
                        <td class="field-label">ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</td>
                        <td>
                            <div class="pw-wrapper">
                                <input type="password" class="input" id="newPwConfirm" name="newPwConfirm" style="width: 280px">
                                <button type="button" class="pw-toggle" data-target="newPwConfirm"
                                        aria-label="ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ë³´ê¸° ì „í™˜">ğŸ‘
                                </button>
                            </div>
                            <div id="pw2Hint" class="hint"></div>
                        </td>
                    </tr>

                </table>
            </div>
        </form>
        <div class="btns">
            <button id="nextBtn" class="btn-register"
                    onclick="openCertModal()"
                    style="display:inline-block; box-sizing:border-box; width:100%; height:42px; line-height:42px; border-radius:8px; background-color:#007BFF; color:white; text-align:center; border:none; cursor:pointer;">
                ë‹¤ìŒ
            </button>
        </div>
        <div class="btns">
            <a th:href="@{/mypage/setup}" class="btn-pressable"
               style="display:inline-block; box-sizing:border-box; width:100%; height:42px; line-height:42px; border-radius:8px; border:1px solid #D1D5DB; background-color:white; text-align:center; color:#111; text-decoration:none;">
                ì·¨ì†Œ
            </a>
        </div>
    </div>
</main>

<!-- ëª¨ë‹¬ì°½ -->
<div id="certModal" aria-hidden="true">
    <div class="modal-backdrop" data-close-modal></div>
    <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="certModalTitle">
        <div class="modal-header">
            <h3 id="certModalTitle" style="margin:0;">ë³¸ì¸í™•ì¸</h3>
            <button type="button" class="modal-close" data-close-modal>&times;</button>
        </div>
        <div class="modal-body">
            <!-- ì¸ì¦ ë°©ì‹ ì„ íƒ íƒ­ -->
            <div class="verify-methods" style="display:flex; gap:10px; margin-bottom:12px;">
                <button type="button" id="method-phone" class="method-card active" style="flex:1;">íœ´ëŒ€í°</button>
                <button type="button" id="method-email" class="method-card" style="flex:1;">ì´ë©”ì¼</button>
            </div>
            <!-- íœ´ëŒ€í° ì¸ì¦ ì˜ì—­ -->
            <div id="panel-phone">
                <div class="field" style="margin-bottom:10px;">
                    <label class="field-label">íœ´ëŒ€í°ë²ˆí˜¸</label>
                    <div class="field-row" style="display:flex; gap:8px;">
                        <input type="text" class="input" id="pwresetPhone" placeholder="010-1234-5678">
                        <button type="button" class="btn-register" id="btnPhoneReq" style="width:90px;">ì¸ì¦ìš”ì²­</button>
                    </div>
                </div>
                <div class="field">
                    <label class="field-label">ì¸ì¦ë²ˆí˜¸</label>
                    <div class="field-row" style="display:flex; gap:8px;">
                        <input type="text" class="input" id="pwresetPhoneCode" placeholder="ì¸ì¦ë²ˆí˜¸ ì…ë ¥" style="flex:1;">
                        <button type="button" class="btn-register" id="btnPhoneVerify" style="width:90px;">í™•ì¸</button>
                    </div>
                </div>
            </div>
            <!-- ì´ë©”ì¼ ì¸ì¦ ì˜ì—­ (ì²˜ìŒì—” ìˆ¨ê¹€) -->
            <div id="panel-email" style="display:none;">
                <div class="field" style="margin-bottom:10px;">
                    <label class="field-label">ì´ë©”ì¼</label>
                    <div class="field-row" style="display:flex; gap:8px;">
                        <input type="text" class="input" id="pwresetEmail" placeholder="example@bank.com">
                        <button type="button" class="btn-register" id="btnEmailReq" style="width:90px;">ì¸ì¦ìš”ì²­</button>
                    </div>
                </div>
                <div class="field">
                    <label class="field-label">ì¸ì¦ë²ˆí˜¸</label>
                    <div class="field-row" style="display:flex; gap:8px;">
                        <input type="text" class="input" id="pwresetEmailCode" placeholder="ì¸ì¦ë²ˆí˜¸ ì…ë ¥" style="flex:1;">
                        <button type="button" class="btn-register" id="btnEmailVerify" style="width:90px;">í™•ì¸</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn-pressable" data-close-modal
                    style="display:inline-block; box-sizing:border-box; width:48%; height:42px; line-height:42px; border-radius:8px; border:1px solid #D1D5DB; background-color:white; text-align:center; color:#111;">
                ì·¨ì†Œ
            </button>
            <button type="button" class="btn-register" id="btnCertSubmit" style="width:48%;">í™•ì¸</button>
        </div>
    </div>
</div>

<footer><div th:replace="~{layouts/footer.html}"></div></footer>
</body>

<script>
    (function () {
        const modal = document.getElementById("certModal");
        const closeBtns = document.querySelectorAll("[data-close-modal]");

        const methodPhone  = document.getElementById("method-phone");
        const methodEmail  = document.getElementById("method-email");
        const panelPhone   = document.getElementById("panel-phone");
        const panelEmail   = document.getElementById("panel-email");

        const btnPhoneReq    = document.getElementById("btnPhoneReq");
        const btnPhoneVerify = document.getElementById("btnPhoneVerify");
        const btnEmailReq    = document.getElementById("btnEmailReq");
        const btnEmailVerify = document.getElementById("btnEmailVerify");
        const btnCertSubmit  = document.getElementById("btnCertSubmit");

        const currentPwInput = document.getElementById("currentPw");
        const newPwInput     = document.getElementById("newPw");
        const newPw2Input    = document.getElementById("newPwConfirm");
        const pwHint         = document.getElementById("pwHint");
        const pw2Hint        = document.getElementById("pw2Hint");
        const currentPwHint  = document.getElementById("currentPwHint");

        let phoneVerified = false;
        let emailVerified = false;
        let currentPwValid = false;

        function validatePasswordStrength(value) {
            const regex = /^(?=.*[A-Za-z])(?=.*\d)(?=.*[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]).{5,15}$/;
            return regex.test(value);
        }

        function checkPasswords() {
            const cur  = currentPwInput.value.trim();
            const pw   = newPwInput.value.trim();
            const pw2  = newPw2Input.value.trim();

            if (!pw) {
                pwHint.textContent = "ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.";
                pwHint.style.color = "#6b7280";
            } else if (cur && pw === cur) {
                pwHint.textContent = "í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ì™€ ë‹¤ë¥¸ ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.";
                pwHint.style.color = "#d6001c";
            } else if (!validatePasswordStrength(pw)) {
                pwHint.textContent = "íŠ¹ìˆ˜ë¬¸ì, ì˜ë¬¸, ìˆ«ì í¬í•¨ 5~15ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.";
                pwHint.style.color = "#d6001c";
            } else if (pw && pw2 && pw === pw2) {
                pwHint.textContent = "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.";
                pwHint.style.color = "#059669";
            } else {
                pwHint.textContent = "ì‚¬ìš© ê°€ëŠ¥í•œ ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤.";
                pwHint.style.color = "#059669";
            }

            if (!pw2) {
                pw2Hint.textContent = "";
            } else if (cur && pw2 === cur) {
                pw2Hint.textContent = "í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ì™€ ë™ì¼í•œ ë¹„ë°€ë²ˆí˜¸ëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
                pw2Hint.style.color = "#d6001c";
            } else if (pw !== pw2) {
                pw2Hint.textContent = "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.";
                pw2Hint.style.color = "#d6001c";
            } else {
                pw2Hint.textContent = "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.";
                pw2Hint.style.color = "#059669";
            }
        }

        newPwInput.addEventListener("input", checkPasswords);
        newPw2Input.addEventListener("input", checkPasswords);
        currentPwInput.addEventListener("input", checkPasswords);

        // í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ ì„œë²„ ê²€ì¦
        async function verifyCurrentPw() {
            const cur = currentPwInput.value.trim();

            if (!cur) {
                currentPwHint.textContent = "í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.";
                currentPwHint.style.color = "#d6001c";
                currentPwValid = false;
                return false;
            }

            try {
                const res = await fetch("/BNK/pw/check-current", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ currentPw: cur })
                });

                if (!res.ok) {
                    currentPwHint.textContent = "í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
                    currentPwHint.style.color = "#d6001c";
                    currentPwValid = false;
                    return false;
                }

                const data = await res.json();
                if (data.ok) {
                    currentPwHint.textContent = "í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.";
                    currentPwHint.style.color = "#059669";
                    currentPwValid = true;
                    return true;
                } else {
                    currentPwHint.textContent = "í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.";
                    currentPwHint.style.color = "#d6001c";
                    currentPwValid = false;
                    return false;
                }
            } catch (e) {
                console.error(e);
                currentPwHint.textContent = "í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
                currentPwHint.style.color = "#d6001c";
                currentPwValid = false;
                return false;
            }
        }

        // input ëë‚´ê³  ë¹ ì ¸ë‚˜ê°ˆ ë•Œ ì„œë²„ ê²€ì¦
        currentPwInput.addEventListener("blur", function () {
            verifyCurrentPw();
        });

        // ë‹¤ìŒ ë²„íŠ¼: ìµœì¢… í¼ ê²€ì¦ + í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ ì„œë²„ ê²€ì¦ í†µê³¼ ì‹œì—ë§Œ ëª¨ë‹¬ ì˜¤í”ˆ
        window.openCertModal = async function () {
            const cur  = currentPwInput.value.trim();
            const npw  = newPwInput.value.trim();
            const npw2 = newPw2Input.value.trim();

            if (!cur || !npw || !npw2) {
                alert("í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ì™€ ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }
            if (cur === npw) {
                alert("í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ì™€ ë‹¤ë¥¸ ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                newPwInput.focus();
                return;
            }
            if (!validatePasswordStrength(npw)) {
                alert("ë¹„ë°€ë²ˆí˜¸ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                newPwInput.focus();
                return;
            }
            if (npw !== npw2) {
                alert("ìƒˆ ë¹„ë°€ë²ˆí˜¸ê°€ ì„œë¡œ ë‹¤ë¦…ë‹ˆë‹¤.");
                newPw2Input.focus();
                return;
            }

            const okCur = await verifyCurrentPw();
            if (!okCur) {
                alert("í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                currentPwInput.focus();
                return;
            }

            modal.setAttribute("aria-hidden", "false");
        };

        closeBtns.forEach(btn =>
            btn.addEventListener("click", () =>
                modal.setAttribute("aria-hidden", "true")
            )
        );

        function setMethod(method) {
            if (method === "phone") {
                methodPhone.classList.add("active");
                methodEmail.classList.remove("active");
                panelPhone.style.display = "block";
                panelEmail.style.display = "none";
            } else {
                methodEmail.classList.add("active");
                methodPhone.classList.remove("active");
                panelEmail.style.display = "block";
                panelPhone.style.display = "none";
            }
        }

        methodPhone.addEventListener("click", () => setMethod("phone"));
        methodEmail.addEventListener("click", () => setMethod("email"));

        // íœ´ëŒ€í° ì¸ì¦ ìš”ì²­
        btnPhoneReq.addEventListener("click", async () => {
            const phone = document.getElementById("pwresetPhone").value.trim();
            if (!phone) {
                alert("íœ´ëŒ€í° ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
                return;
            }

            const res = await fetch("/BNK/api/verification/sms/send", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ phoneNumber: phone })
            });

            const json = await res.json();
            if (json.ok) {
                alert("íœ´ëŒ€í° ì¸ì¦ë²ˆí˜¸ê°€ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
            } else {
                alert(json.message || "ì¸ì¦ë²ˆí˜¸ ë°œì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
            }
        });

        // íœ´ëŒ€í° ì¸ì¦ë²ˆí˜¸ ê²€ì¦
        btnPhoneVerify.addEventListener("click", async () => {
            const phone = document.getElementById("pwresetPhone").value.trim();
            const code = document.getElementById("pwresetPhoneCode").value.trim();

            if (!code) {
                alert("ì¸ì¦ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
                return;
            }

            const res = await fetch("/BNK/api/verification/sms/verify", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ phoneNumber: phone, code })
            });

            const json = await res.json();
            if (json.ok) {
                phoneVerified = true;
                emailVerified = false;
                alert("íœ´ëŒ€í° ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
            } else {
                alert(json.message || "ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
            }
        });

        // ì´ë©”ì¼ ì¸ì¦ ìš”ì²­
        btnEmailReq.addEventListener("click", async () => {
            const email = document.getElementById("pwresetEmail").value.trim();
            if (!email) {
                alert("ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”.");
                return;
            }

            const res = await fetch("/BNK/api/verification/email/send", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email })
            });

            const json = await res.json();
            if (json.send) {
                alert("ì´ë©”ì¼ ì¸ì¦ë²ˆí˜¸ê°€ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
            } else {
                alert("ë°œì†¡ ì‹¤íŒ¨: " + (json.error || ""));
            }
        });

        // ì´ë©”ì¼ ì½”ë“œ ê²€ì¦
        btnEmailVerify.addEventListener("click", async () => {
            const code = document.getElementById("pwresetEmailCode").value.trim();
            if (!code) {
                alert("ì¸ì¦ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
                return;
            }

            const res = await fetch("/BNK/api/verification/email/verify", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ code })
            });

            const json = await res.json();
            if (json.matched) {
                emailVerified = true;
                phoneVerified = false;
                alert("ì´ë©”ì¼ ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
            } else {
                alert("ì¸ì¦ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            }
        });

        // ëª¨ë‹¬ì—ì„œ "í™•ì¸" â†’ ì‹¤ì œ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í˜¸ì¶œ
        btnCertSubmit.addEventListener("click", async () => {
            if (!phoneVerified && !emailVerified) {
                alert("íœ´ëŒ€í° ë˜ëŠ” ì´ë©”ì¼ ì¸ì¦ì„ ë¨¼ì € ì™„ë£Œí•´ì£¼ì„¸ìš”.");
                return;
            }

            const curPw = currentPwInput.value.trim();
            const npw   = newPwInput.value.trim();

            if (!curPw || !npw) {
                alert("í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ì™€ ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            try {
                const res = await fetch("/BNK/pw/change", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        currentPw: curPw,
                        newPw: npw
                    })
                });

                if (!res.ok) {
                    const text = await res.text();
                    alert(text || "ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
                    return;
                }

                alert("ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.");
                modal.setAttribute("aria-hidden", "true");
                window.location.href = "/BNK/mypage/main";

            } catch (err) {
                console.error(err);
                alert("ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            }
        });

        document.querySelectorAll(".pw-toggle").forEach(btn => {
            btn.addEventListener("click", () => {
                const targetId = btn.dataset.target;
                const input = document.getElementById(targetId);
                if (!input) return;

                const isHidden = input.type === "password";
                input.type = isHidden ? "text" : "password";

                btn.textContent = isHidden ? "ğŸ™ˆ" : "ğŸ‘";
            });
        });

        setMethod("phone");
    })();
</script>

<style>
    main {
        width: 1200px;
        background-color: #F6F6F8;
        padding: 80px 20px;
        margin: 0 auto;
    }
    body {
        font-family: 'Noto Sans KR', 'ë§‘ì€ ê³ ë”•', sans-serif;
        background: #F6F6F8;
        color: #111827;
        line-height: 1.5;
    }
    .form-card {
        max-width: 420px;
        background: #fff;
        border: 1px solid #e5e7eb;
        border-radius: 20px;
        box-shadow: 0 10px 20px rgba(2,6,23,.06);
        padding: 28px 35px;
        margin: 0 auto;
    }
    .field-row {
        padding-left: 5px;
        display: flex;
        margin: 5px;
    }
    .field-row td {
        padding: 10px 0;
    }
    .field-row td:first-child {
        height: 40px;
        line-height: 40px;
        font-weight: 600;
    }
    .field-row input {
        width: 250px;
        height: 40px;
        border: 1px solid #bbb;
        border-radius: 10px;
        padding: 0 12px;
        box-sizing: border-box;
        outline: none;
    }
    .input:focus {
        border-color: #d1d5db;
        box-shadow: 0 0 0 3px rgba(214, 0, 28, .12);
    }
    .field-row td + td {
        padding-left: 5px;
    }
    .field-label {
        width: 120px;
        font-weight: 600;
        vertical-align: middle;
    }
    .table-wrap {
        width: 100%;
    }
    .table-wrap table {
        width: 100%;
    }
    .btns { display: flex; justify-content: center; gap: 10px; margin-top: 22px; }

    /* íŒíŠ¸ í…ìŠ¤íŠ¸ */
    .hint {
        font-size: 12px;
        color: #6b7280;
        margin-top: 4px;
        min-height: 18px;
    }

    /*  ëª¨ë‹¬ style  */
    #certModal[aria-hidden="true"] { display:none; }
    #certModal[aria-hidden="false"] { display:block; }
    #certModal .modal-backdrop {
        position:fixed;
        inset:0;
        background:rgba(0,0,0,.45);
        backdrop-filter: blur(2px);
    }
    #certModal .modal-dialog {
        position:fixed;
        left:50%;
        top:50%;
        transform:translate(-50%, -50%);
        width: 350px;
        max-width: 92vw;
        background:#fff;
        border:1px solid #e5e7eb;
        border-radius:16px;
        box-shadow:0 20px 60px rgba(2,6,23,.2);
        padding:18px;
    }
    #certModal .modal-header {
        display:flex;
        justify-content:space-between;
        align-items:center;
        margin-bottom:8px;
    }
    #certModal .modal-close {
        width:32px;
        height:32px;
        border-radius:8px;
        border:1px solid #e5e7eb;
        background:#fff;
        cursor:pointer;
    }
    #certModal .modal-body {
        padding: 6px 2px;
    }
    #certModal .modal-footer {
        display:flex;
        gap:10px;
        margin-top:14px;
    }
    .method-card {
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        background: #fff;
        padding: 8px 0;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
    }
    .method-card.active {
        border-color: #d6001c;
        color: #d6001c;
    }
    .pw-wrapper {
        position: relative;
        width: 100%;
    }
    .pw-wrapper .input {
        width: 100%;
        padding-right: 36px;
    }
    .pw-toggle {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        border: none;
        background: transparent;
        cursor: pointer;
        font-size: 16px;
        line-height: 1;
        padding: 0;
    }
</style>
</html>