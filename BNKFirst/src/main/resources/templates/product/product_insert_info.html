<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>상품 정보입력</title>
    <link rel="stylesheet" href="../../static/css/product/product_insert_info.css">
</head>

<body>
    <header>
        <div id="header"></div>
    </header>
    <main>
        <!-- 1) 스텝퍼 -->
        <ol class="stepper" id="wizardSteps" aria-label="신청 진행 단계">
            <li class="step active" aria-current="step"><span class="dot">1</span> 본인확인서 등록</li>
            <li class="step"><span class="dot">2</span> 약관동의</li>
            <li class="step"><span class="dot">3</span> 중요내용</li>
            <li class="step"><span class="dot">4</span> 정보입력</li>
            <li class="step"><span class="dot">5</span> 계좌개설</li>
        </ol>

        <!-- 2) 단계별 패널 (한 페이지에 모두 존재) -->
        <section class="step-page" id="page1">
            <h1>본인확인서(FATCA/CRS)등록</h1>
            <div class="info-box">
                <div class="info-title">
                    <img src="/images/product/info-blue.png" alt="" class="info-icon">
                    <strong>본인확인서 관련 안내</strong>
                </div>
                <ul class="info-text">
                    <li>상호주의에 따른 정기적인 금융정보의 교환을 위한 조세조약의 이행과 관련하여 국제조세 조정에 관한 법률에 따라 작성이 요구됩니다.</li>
                    <li>부산은행으로부터 본인확인서 재작성 또는 증빙자료를 요청받는 경우, 기재 내용에 변경이 있을 경우 <span class="info-red">60일 이내에
                            통지</span>하여야 합니다.</li>
                    <li>관련정보를 제공하지 않거나, 허위로 제공할 경우 향후 거래에 제한이 발생할 수 있으며, <span class="info-red">국세청 의무이행방해자로 신고</span>될
                        수 있습니다.</li>
                </ul>

                <div class="warn-box">
                    <img src="/images/product/time-yellow.png" alt="" class="warn-icon">
                    <span>귀속년도는 고객님께서 작성하는 본인확인서 정보의 기존연도를 의미합니다. 예를 들어 2021년 12월 31일 기준으로 본인확인서 정보를 입력하실 경우, 귀속년도는
                        2021년에 해당합니다.</span>
                </div>
            </div>
            <article class="card form-section">
                <div class="inner">
                    <h2 class="form-title">
                        <img src="/images/product/user-red.png" alt="" class="form-icon">
                        고객 기본 정보
                    </h2>

                    <form id="customerForm" class="form-grid">
                        <div class="form-group">
                            <label for="name">성명<span class="req">*</span></label>
                            <input id="name" type="text" placeholder="홍길동">
                        </div>

                        <div class="form-group">
                            <label>성별<span class="req">*</span></label>
                            <div class="radio-row">
                                <label><input type="radio" name="gender" value="남성"> 남성</label>
                                <label><input type="radio" name="gender" value="여성"> 여성</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="birth">생년월일<span class="req">*</span></label>
                            <input id="birth" type="date" placeholder="YYYY-MM-DD">
                        </div>

                        <div class="form-group">
                            <label for="nation">국적<span class="req">*</span></label>
                            <select id="nation">
                                <option>선택해 주세요</option>
                                <option>대한민국</option>
                                <option>미국</option>
                                <option>일본</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="residence">귀속연도<span class="req">*</span></label>
                            <select id="residence">
                                <option>선택해 주세요</option>
                                <option>2025</option>
                                <option>2024</option>
                                <option>2023</option>
                                <option>2022</option>
                                <option>2021</option>
                            </select>
                        </div>

                        <div class="form-group">
                        </div>

                        <div class="form-group">
                            <label for="engLastName">영문성명<span class="req">*</span></label>
                            <div style="display: flex; gap: 10px;">
                                <input id="engLastName" class="engName" type="text" placeholder="HONG">
                                <input id="engFirstName" class="engName" type="text" placeholder="GIL DONG">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="phone">휴대전화번호<span class="req">*</span></label>
                            <input id="phone" type="tel" placeholder="010-1234-5678">
                        </div>

                        <div class="form-group full">
                            <label>주소<span class="req">*</span></label>
                            <div class="addr-row">
                                <input name="zipcode" type="text" placeholder="우편번호" style="flex:none">
                                <button type="button" class="btn-white small">주소검색</button>
                            </div>
                            <input name="addr1" type="text" placeholder="도로명 주소">
                            <input name="addr2" type="text" placeholder="상세주소">
                        </div>
                    </form>
                </div>
            </article>
            <article class="confirm-box">
                <h2 class="confirm-title">
                    <img src="/images/product/check-red.png" alt="확인사항" class="confirm-icon">
                    확인사항(해당하는 항복에 모두 체크)
                </h2>
                <label class="confirm-item" for="isKorean">
                    <input type="checkbox" name="nation" id="isKorean">
                    조세목적상 한국 거주자에 해당합니다.
                    <img src="/images/product/detail-grey.png" alt="세부정보">
                </label>
                <label class="confirm-item" for="isForeign">
                    <input type="checkbox" name="nation" id="isForeign">
                    한국 외에 조세목적상 거주지국이 있습니다.
                </label>
            </article>
        </section>
        <section class="step-page" id="page2" hidden>
            <h1 style="margin-bottom: 5px;">신규가입</h1>
            <ul style="padding: 10px 25px 10px;color: #606060;margin-top: 0;">
                <li>아래의 [예금거래 약관 동의 및 개별약관 동의]를 확인하신 후 동의하시면 "동의함" 버튼을 클릭하시기 바랍니다.</li>
            </ul>
            <h3 class="product-name" style="text-align: center;">저탄소 실천 적금</h3>
            <article class="accept-terms">
                <div class="terms-title">
                    <h2>상품설명서 및 약관 동의</h2>
                    <ul>
                        <li>상품 신규가입을 위해서는 상품설명서 및 약관을 반드시 다운로드 받거나 읽어보셔야 합니다.</li>
                    </ul>
                </div>
                <div class="terms-list">
                    <div class="terms-item">
                        <span>기본약관</span>
                        <a href="#" download class="icon-btn" aria-label="기본약관 다운로드">
                            <svg width="28" height="28" viewBox="0 0 24 24" role="img" aria-label="문서 다운로드" fill="none"
                                stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M6 2h7l5 5v11a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z" />
                                <path d="M13 2v5h5" stroke-linecap="butt" />
                                <g transform="translate(-1,0)">
                                    <path d="M12 10v6" />
                                    <path d="m9 13 3 3 3-3" />
                                </g>
                                <path d="M8 20h8" />
                            </svg>
                        </a>
                    </div>
                    <div class="terms-item">
                        <span>유형별약관</span>
                        <a href="#" download class="icon-btn" aria-label="유형별약관 다운로드">
                            <svg width="28" height="28" viewBox="0 0 24 24" role="img" aria-label="문서 다운로드" fill="none"
                                stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M6 2h7l5 5v11a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z" />
                                <path d="M13 2v5h5" stroke-linecap="butt" />
                                <g transform="translate(-1,0)">
                                    <path d="M12 10v6" />
                                    <path d="m9 13 3 3 3-3" />
                                </g>
                                <path d="M8 20h8" />
                            </svg>
                        </a>
                    </div>
                    <div class="terms-item">
                        <span>개별약관</span>
                        <a href="#" download class="icon-btn" aria-label="개별약관 다운로드">
                            <svg width="28" height="28" viewBox="0 0 24 24" role="img" aria-label="문서 다운로드" fill="none"
                                stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M6 2h7l5 5v11a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z" />
                                <path d="M13 2v5h5" stroke-linecap="butt" />
                                <g transform="translate(-1,0)">
                                    <path d="M12 10v6" />
                                    <path d="m9 13 3 3 3-3" />
                                </g>
                                <path d="M8 20h8" />
                            </svg>
                        </a>
                    </div>
                    <div class="terms-item">
                        <span>상품설명서</span>
                        <a href="#" download class="icon-btn" aria-label="상품설명서 다운로드">
                            <svg width="28" height="28" viewBox="0 0 24 24" role="img" aria-label="문서 다운로드" fill="none"
                                stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M6 2h7l5 5v11a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z" />
                                <path d="M13 2v5h5" stroke-linecap="butt" />
                                <g transform="translate(-1,0)">
                                    <path d="M12 10v6" />
                                    <path d="m9 13 3 3 3-3" />
                                </g>
                                <path d="M8 20h8" />
                            </svg>
                        </a>
                    </div>
                </div>
                <div class="esn-info">
                    <h2>필수 안내사항</h2>
                    <div class="info-wrapper">
                        <div class="info-card">
                            <div class="info-title">
                                <img src="/images/product/info-red.png" alt="설명의무 관련 확인서">
                                <h3>설명의무 관련 확인서(차명거래 금지에 관한 설명)</h3>
                            </div>
                            <ul>
                                <li><b>「금융실명거래 및 비밀보장에 관한법률 제3조 제3항</b> 에 따라 불법 재산의 은닉, 자금세탁 행위, 공중협박자금조달행위 및 강제 집행의 면탈,
                                    그 밖의 탈법행위를 목적으로 타인의 실명으로 금융거래를 하여서는 아니 되며, 이를 위반시 5년 이하의 징역 또는 5천만원 이하의 벌금에 처할 수
                                    있습니다.</li>
                            </ul>
                        </div>
                        <div class="info-card">
                            <div class="info-title">
                                <img src="/images/product/shield-red-circle.png" alt="예금보험관계 설명 확인">
                                <h3>예금보험관계 설명 확인</h3>
                            </div>
                            <ul>
                                <li>본인이 가입하는 금융상품의 예금자보호여부 및 보호한도(원금과 소정의 이자를 합하여 1인당 1억원)에 대하여 이해하였음을 확인합니다.(상품설명서 또는
                                    상품설명 페이지 참조)</li>
                            </ul>
                        </div>
                    </div>
                    <div class="info-confirm">
                        <div class="confirm-content"><b>위 안내에 대하여 충분히 이해하였음을 확인합니다.</b></div>
                        <div class="confirm-check">
                            <label for="esn-info">
                                <input type="checkbox" name="esn-info" id="esn-info"> <b
                                    style="color: #467abd;">확인합니다.</b>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="terms-confirm">
                    <label for="terms-confirm">
                        <input type="checkbox" name="terms-confirm" id="terms-confirm"> <b style="color: #467abd;">상품에
                            대한 설명 및 약관에 충분히 이해했고
                            동의합니다.</b>
                    </label>
                </div>
            </article>
            <article class="get-terms card">
                <form novalidate>
                    <h3>약관 및 상품설명서 받기</h3>
                    <div class="field">
                        <span class="field-label">수령 방법 선택</span>
                        <div class="radio-group" role="radiogroup" aria-label="수령 방법 선택">
                            <label class="radio">
                                <input type="radio" name="receive" value="sms" checked>
                                문자(SMS)로 받기
                            </label>
                            <label class="radio">
                                <input type="radio" name="receive" value="email">
                                이메일로 받기
                            </label>
                        </div>
                    </div>

                    <div class="field input-field">
                        <label id="contact-label" for="contactInput" class="sr-only">연락처 입력</label>
                        <input id="contactInput" class="text-input" type="tel" inputmode="numeric" autocomplete="tel"
                            placeholder="휴대폰 번호 (‘-’ 없이)" required pattern="^01[0-9]{8,9}$"
                            aria-describedby="contact-help contact-error">
                        <p class="help" id="contact-help">휴대폰 번호는 ‘-’ 없이 숫자만 입력해 주세요.</p>
                        <p class="error" id="contact-error" aria-live="polite"></p>
                    </div>
                </form>
            </article>
        </section>
        <section class="step-page" id="page3" hidden>
            <h1 style="margin-bottom: 5px;">금융상품에 대한 중요내용</h1>
            해당 내용은 금융소비자보호법 제19조 제1항에서 규정하고 있는 중요한 사항입니다.<br>
            아래의 사항을 확인 후 체크하여 주시기 바랍니다.
            <article class="b-and-p-int-rates card-white">
                <div class="doc-title">
                    <h2>
                        <img src="/images/product/percent-red.png" alt="기본이율과 우대이율">
                        기본이율과 우대이율
                    </h2>
                    <span>
                        <label for="int-rates-confirm">
                            <input type="checkbox" name="int-rates-confirm" id="int-rates-confirm">
                            확인했습니다.
                        </label>
                    </span>
                </div>
                <div class="card-grey">
                    <div class="content-title">기본이율</div>
                    <div class="content-description">상품가입일 기준 영업점 및 인터넷 홈페이지에 고시된 계약기간별 이율</div>
                </div>
                <div class="card-grey">
                    <div class="content-title">우대이율</div>
                    <div class="content-description">상품별, 고객별 우대조건에 따라 개인별로 차등하여 적용되는 이율</div>
                </div>
                <p>※ 최종이율은 기본이율과 우대이율을 합산하여 적용되며, 개별상품에 따라 변경될 수 있습니다.</p>
            </article>
            <article class="int-pay-date card-white">
                <div class="doc-title">
                    <h2>
                        <img src="/images/product/calender-red.png" alt="이자지급시기">
                        이자지급시기
                    </h2>
                    <span>
                        <label for="pay-date-confirm">
                            <input type="checkbox" name="pay-date-confirm" id="pay-date-confirm">
                            확인했습니다.
                        </label>
                    </span>
                </div>
                <div class="card-grey">
                    <div class="content-title">만기일시지급</div>
                    <div class="content-description">이율에 따른 이자를 예금만기 해지시 한번에 지급</div>
                </div>
                <div class="card-grey">
                    <div class="content-title">월 단위 지급</div>
                    <div class="content-description">이율에 따른 이자를 월별로 나눠서 지급</div>
                </div>
                <p>※ 이자지급시기는 개별상품에 따라 변경될 수 있습니다.</p>
            </article>
            <article class="int-calc-basis card-white">
                <div class="doc-title">
                    <h2>
                        <img src="/images/product/calculator-none-bg.png" alt="만기이자 산출근거">
                        만기이자 산출근거
                    </h2>
                    <span>
                        <label for="calc-basis-confirm">
                            <input type="checkbox" name="calc-basis-confirm" id="calc-basis-confirm">
                            확인했습니다.
                        </label>
                    </span>
                </div>
                <div class="card-grey">
                    <div class="content-title">거치식 예금</div>
                    <div class="content-description">신규일로부터 만기일 전일까지의 기간에 대하여 약정이율로 셈한 이자를 합계하여 지급</div>
                </div>
                <div class="card-grey">
                    <div class="content-title">적립식 예금</div>
                    <div class="content-description">저축금마다 입금일로부터 만기일 전일까지 기간에 대하여 약정이율로 셈한 이자를 합하여 지급 (원미만 절사)</div>
                </div>
                <p>※ 만기이자 계산방법 및 산출 근거는 개별상품에 따라 변경될 수 있습니다.</p>
            </article>
            <article class="dps-int-rates-note card-white">
                <div class="doc-title">
                    <h2>
                        <img src="/images/product/caution-red.png" alt="예금이율 유의사항">
                        예금이율 유의사항
                    </h2>
                    <span>
                        <label for="rates-note-confirm">
                            <input type="checkbox" name="rates-note-confirm" id="rates-note-confirm">
                            확인했습니다.
                        </label>
                    </span>
                </div>
                <div class="card-red">
                    <ul>
                        <li>이율은 신규가입일 당시 계약기간별 기본이율에 고객별 우대이율을 합산하여 지급합니다.</li>
                        <li>단, 거래실적 등 우대조건 미충족 시 최종금리가 달라질 수 있습니다.</li>
                    </ul>
                    <p>※ 금리변동형 상품은 약정기간 중 금리가 변동 될 수 있으며 금리상승기에 약정금리 인상 가능성이 큰 반면, 금리하락기에는 약정 금리인하로 소비자에게 불리할 수 있습니다.
                    </p>
                </div>
            </article>
            <article class="disadvantages card-white">
                <div class="doc-title">
                    <h2>
                        <img src="/images/product/minus-coin.svg" alt="중도해지에 따른 불이익">
                        중도해지에 따른 불이익
                    </h2>
                    <span>
                        <label for="disadvantages-confirm">
                            <input type="checkbox" name="disadvantages-confirm" id="disadvantages-confirm">
                            확인했습니다.
                        </label>
                    </span>
                </div>
                <div class="card-grey">
                    <b>중도해지이율 예시</b>
                    <ul>
                        <li>기본이율 × 적용율(기간별) × 경과일수/계약일수</li>
                    </ul>
                    <b>중도해지이율은 가입일 당시 이 예금의 기본이율을 초과할 수 없으며,<br>
                        중도해지이자는 가입당시 약정한 세전이자 금액을 초과할 수 없습니다.</b>
                </div>
                <p>※ 중도해지이율에 대한 자세한 내용은 상품설명서를 참조 바랍니다.</p>
            </article>
            <article class="p-i-limit card-white">
                <div class="doc-title">
                    <h2>
                        <img src="/images/product/shield-red-none-bg.png" alt="원금 및 이자 지급제한">
                        원금 및 이자 지급제한
                    </h2>
                    <span>
                        <label for="p-i-limit-confirm">
                            <input type="checkbox" name="p-i-limit-confirm" id="p-i-limit-confirm">
                            확인했습니다.
                        </label>
                    </span>
                </div>
                <div class="card-grey">
                    <img src="/images/product/doc-grey.png" alt="계좌 등록 사항 관련">
                    <p>계좌에 <span>압류, 가압류, 질권설정</span> 등이 등록될 경우 원금 및 이자 지급이 제한됩니다.</p>
                </div>
                <div class="card-grey">
                    <img src="/images/product/hammer-grey.png" alt="민사집행법">
                    <p>민사집행법에 따라 최저생계비 이하 등 압류금지채권에 해당하는 경우에는 법원에 압류 금지채권 범위 변경 신청 등을 통해 압류를 취소할 수 있습니다.</p>
                </div>
                <div class="card-grey">
                    <img src="/images/product/forbidden-grey.png" alt="예금잔액증명서">
                    <p><span>예금잔액증명서 발급 당일</span>에는 입금·출금 이체 등 잔액 변동이 불가하므로 지급이 제한됩니다.</p>
                </div>
                <p>※ 중도해지이율에 대한 자세한 내용은 상품설명서를 참조 바랍니다.</p>
            </article>
            <article class="doc-all-confirm card-white">
                <label for="doc-all-confirm">
                    <input type="checkbox" name="doc-all-confirm" id="doc-all-confirm">
                    금융상품에 대한 중요사항 설명에 대해 모두 확인했습니다.
                </label>
                <p>※ 위 사항은 금융소비자보호법 제19조 제1항에 규정하고 있는 중요한 사항입니다.</p>
            </article>
        </section>
        <section class="step-page" id="page4" hidden>
            <h1>신규가입</h1>
            <div class="warning-info card-white">
                <p>
                    비과세종합저축으로 전환하고자 할 경우에는 신규일 포함 15일 이내에 본인이 신분증과 자격서류를 지참하여 영업점에서 신청하
                    시기 바랍니다.<br>
                    비과세종합저축 가입시 계약기간 만료일 이후의 이자소득은 비과세가 적용되지 않습니다.<br>
                    본 상품 해지 시 원리금은 연결계좌(신규시 사용된 출금계좌)로만 입금 가능하며,영업점에서 해지 시 연결계좌가 한도제한계좌인
                    경우 금융거래목적을 입증하는 서류를 지참해야 해지가 가능합니다.
                </p>
            </div>
            <article class="consumer-info card-white">
                <h2>가입자정보</h2>
                <div class="form-row" style="width: 50%;">
                    <label class="label">상품명</label>
                    <input class="input" value="홍길동" readonly>
                </div>
            </article>
            <article class="insert-info card-white">
                <div class="insert-title">
                    <h2>신규가입자정보입력</h2>
                    <span>필수입력항목</span>
                </div>
                <div class="form-grid">

                    <!-- 상품명 -->
                    <div class="form-row">
                        <label class="label">상품명</label>
                        <input class="input" value="저탄소 실천 적금" readonly>
                    </div>

                    <!-- 빈칸(정렬 맞춤) -->
                    <div></div>

                    <!-- 이자지급구분 -->
                    <div class="form-row">
                        <label class="label">이자지급구분 <span class="req">*</span></label>
                        <div class="radio-row">
                            <label class="radio"><input type="radio" name="paytype" value="만기" checked>만기일시지급</label>
                            <label class="radio"><input type="radio" name="paytype" value="월지급">월지급</label>
                        </div>
                    </div>

                    <!-- 출금계좌번호 (우측) -->
                    <div class="form-row">
                        <label class="label">출금계좌번호 <span class="req">*</span></label>
                        <div class="select">
                            <select class="input" aria-label="출금계좌번호">
                                <option selected>계좌를 선택해 주세요</option>
                                <option>부산은행 123-456-789012</option>
                                <option>부산은행 555-000-111222</option>
                            </select>
                        </div>
                    </div>

                    <!-- 계약기간 -->
                    <div class="form-row">
                        <label class="label">계약기간 <span class="req">*</span></label>
                        <div class="Chips" id="termChips">
                            <button type="button" class="Chip active" data-month="6">6개월</button>
                            <button type="button" class="Chip" data-month="12">12개월</button>
                            <button type="button" class="Chip" data-month="24">24개월</button>
                            <button type="button" class="Chip" data-month="36">36개월</button>
                            <button type="button" class="Chip" data-type="date">만기일자</button>
                            <div style="flex:1 0 120px"></div>
                        </div>
                        <div class="spacer"></div>
                        <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap">
                            <div class="unit-wrap" style="width:160px">
                                <input id="termMonths" class="input unit-padding" type="number" min="6" max="36"
                                    value="6" aria-label="개월 입력">
                                <span class="unit">개월</span>
                            </div>
                            <input id="termDate" class="input" type="date" aria-label="만기일자"
                                style="width:200px; display:none">
                            <span class="help">※ 6개월 이상 ~ 36개월 이내로 입력해 주세요.</span>
                        </div>
                    </div>

                    <!-- 목표금액 -->
                    <div class="form-row">
                        <label class="label">목표금액 (선택)</label>
                        <div class="unit-wrap">
                            <input id="goal" class="input unit-padding" placeholder="목표금액 입력">
                            <span class="unit">원</span>
                        </div>
                    </div>

                    <!-- 출금구분 -->
                    <div class="form-row">
                        <label class="label">출금구분 <span class="req">*</span></label>
                        <div class="radio-row">
                            <label class="radio"><input type="radio" name="outtype" checked>부산은행계좌</label>
                            <label class="radio"><input type="radio" name="outtype">다른금융계좌</label>
                        </div>
                    </div>

                    <!-- 자동이체계좌 -->
                    <div class="form-row">
                        <label class="label">자동이체계좌</label>
                        <div class="select">
                            <select class="input" aria-label="자동이체계좌">
                                <option selected>계좌를 선택해 주세요</option>
                                <option>부산은행 123-456-789012</option>
                            </select>
                        </div>
                    </div>

                    <!-- 최초불입금액 -->
                    <div class="form-row">
                        <label class="label">최초불입금액 <span class="req">*</span></label>
                        <div class="chips" id="firstAmtChips">
                            <button type="button" class="Chip" data-won="10000">1만원</button>
                            <button type="button" class="Chip" data-won="100000">10만원</button>
                            <button type="button" class="Chip" data-won="500000">50만원</button>
                            <button type="button" class="Chip" data-won="1000000">100만원</button>
                            <button type="button" class="Chip" data-won="">직접입력</button>
                        </div>
                        <div class="unit-wrap" style="margin-top:8px">
                            <input id="firstAmt" class="input unit-padding" placeholder="1만원 - 1천만원"
                                inputmode="numeric">
                            <span class="unit">원</span>
                        </div>
                    </div>

                    <!-- 자동이체신청 -->
                    <div class="form-row">
                        <label class="label">자동이체신청 <span class="req">*</span></label>
                        <span class="help">※ 자동이체 금액은 최초 가입금액으로 자동 설정됩니다.</span>
                        <div class="radio-row">
                            <label class="radio"><input type="radio" name="autotrans" checked>신청</label>
                            <label class="radio"><input type="radio" name="autotrans">미신청</label>
                        </div>
                    </div>

                    <!-- 고객 알림 서비스 -->
                    <div class="form-row">
                        <label class="label">고객 알림 서비스 <span class="req">*</span></label>
                        <div class="radio-row">
                            <label class="radio"><input type="radio" name="notice" checked>PUSH 알림</label>
                            <label class="radio"><input type="radio" name="notice">SMS 알림</label>
                            <label class="radio"><input type="radio" name="notice">미신청</label>
                        </div>
                        <span class="help">※ 고객알리미 서비스란? 상품별 우대이율 달성 조건을 만기 3개월 전 (가입기간 24개월 초과 상품은 만기 6개월
                            전) SMS(PUSH)를 통해 고객에게 안내해 드리는 서비스</span>
                    </div>

                    <!-- 비과세종합저축 선택 -->
                    <div class="form-row full">
                        <label class="label">비과세종합저축가입내역 및 비과세 선택</label>
                        <div class="tax-box">
                            <div class="card-grey">
                                <label class="radio"><input type="radio" name="tax" checked>일반과세</label>
                            </div>
                            <div class="card-grey">
                                <div class="radio-wrapper">
                                    <label class="radio"><input type="radio" name="tax">비과세종합저축</label>
                                </div>
                                <div class="tax-note">
                                    비과세종합저축 잔여한도액: 3,000,000원<br>비과세종합저축 가입총액: 5,000,000원
                                </div>
                            </div>
                            <div class="button-wrapper">
                                <button class="btn-secondary" type="button">다시입력</button>
                            </div>
                        </div>
                    </div>

                    <!-- 권유직원정보 -->
                    <div class="form-row full">
                        <label class="label">권유직원정보 (선택)</label>
                        <div class="search-buttons">
                            <button type="button" class="sbtn">
                                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                                    <circle cx="11" cy="11" r="7" />
                                    <path d="m21 21-4.3-4.3" />
                                </svg>
                                지역 검색
                            </button>
                            <button type="button" class="sbtn">
                                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                                    <path d="M3 12h18M3 6h18M3 18h18" />
                                </svg>
                                점 지정 검색
                            </button>
                            <button type="button" class="sbtn">
                                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                                    <circle cx="12" cy="7" r="4" />
                                    <path d="M5.5 21a7.5 7.5 0 0 1 13 0" />
                                </svg>
                                직원 검색
                            </button>
                        </div>
                    </div>

                    <!-- 안내 배너들 -->
                    <div class="form-row full">
                        <div class="alert red">
                            <img src="/images/product/caution-red.png" alt="보이스피싱 예방 안내">
                            <div>
                                <b>보이스피싱 예방 안내</b><br>
                                <span class="muted">은행에서는 개인정보나 비밀번호를 요구하는 전화를 하지 않습니다. 의심스러운 전화는 즉시 신고해 주세요.</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-row full">
                        <div class="alert blue">
                            <img src="/images/product/info-blue.png" alt="중도해지 안내">
                            <div>
                                <b>중도해지 안내</b><br>
                                <span class="muted">계약기간 중 해지 시 약정금리보다 낮은 중도해지금리가 적용되며, 해지수수료가 부과될 수 있습니다.</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-row full">
                        <div class="alert yellow">
                            <img src="/images/product/phone-yellow.png" alt="ARS 인증 필요">
                            <div>
                                <b>ARS 인증 필요</b><br>
                                <span class="muted">상품 가입 완료를 위해 ARS 전화인증이 필요합니다. 신청 후 5분 이내에 고객님의 휴대폰으로 인증 전화가
                                    갑니다.</span>
                            </div>
                        </div>
                    </div>

                </div>
            </article>
        </section>
        <section class="step-page" id="page5" hidden>
            <div class="page">
                <h1>신규상품 개설 신청</h1>
                <p class="sub">입력하신 정보를 확인하고 신청을 완료해주세요.</p>

                <!-- 신청 정보 요약 -->
                <section class="card">
                    <div class="title-row">
                        <!-- 문서 아이콘 -->
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--red-600)"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.1.9 2 2 2h12a2 2 0 0 0 2-2V8z" />
                            <path d="M14 2v6h6" />
                        </svg>
                        <h2>신청 정보 요약</h2>
                    </div>
                    <div class="summary">
                        <div class="srow">
                            <div class="cell label">가입자명</div>
                            <div class="cell value">홍길동</div>
                            <div class="cell label">최초불입금</div>
                            <div class="cell value">10,000,000원</div>
                        </div>
                        <div class="srow">
                            <div class="cell label">상품명</div>
                            <div class="cell value">BNK정기예금</div>
                            <div class="cell label">자동이체 여부</div>
                            <div class="cell value">신청</div>
                        </div>
                        <div class="srow">
                            <div class="cell label">이자지급구분</div>
                            <div class="cell value">만기일시지급</div>
                            <div class="cell label">자동이체 일자</div>
                            <div class="cell value">매월 25일</div>
                        </div>
                        <div class="srow">
                            <div class="cell label">계약기간</div>
                            <div class="cell value">12개월</div>
                            <div class="cell label">과세구분</div>
                            <div class="cell value">일반과세</div>
                        </div>
                        <div class="srow">
                            <div class="cell label">출금계좌</div>
                            <div class="cell value">123-456-789012</div>
                            <div class="cell label">알림서비스</div>
                            <div class="cell value">SMS 신청</div>
                        </div>
                        <div class="srow two-col">
                            <div class="cell label">자동이체 계좌</div>
                            <div class="cell value">부산은행 123-456-789012</div>
                        </div>
                    </div>
                </section>

                <!-- 보안 정보 설정 -->
                <section class="card">
                    <div class="title-row">
                        <!-- 방패 경고 -->
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--red-600)"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 2l7 4v6c0 5-3.5 9-7 10-3.5-1-7-5-7-10V6z" />
                            <path d="M12 8v4" />
                            <path d="M12 16h.01" />
                        </svg>
                        <h2>보안 정보 설정</h2>
                    </div>

                    <div class="field">
                        <div class="labelline">신규추진 비밀번호 (숫자 4자리)</div>
                        <div class="pin-wrap" id="pin1">
                            <div class="pin-box"><input class="pin" inputmode="numeric" maxlength="1"
                                    autocomplete="one-time-code" aria-label="첫째 자리"></div>
                            <div class="pin-box"><input class="pin" inputmode="numeric" maxlength="1"
                                    aria-label="둘째 자리"></div>
                            <div class="pin-box"><input class="pin" inputmode="numeric" maxlength="1"
                                    aria-label="셋째 자리"></div>
                            <div class="pin-box"><input class="pin" inputmode="numeric" maxlength="1"
                                    aria-label="넷째 자리"></div>
                        </div>
                        <div class="hint" id="pin1Hint">연속되거나 반복되는 숫자는 사용할 수 없습니다.</div>
                    </div>

                    <div class="field">
                        <div class="labelline">신규추진 비밀번호 확인</div>
                        <div class="pin-wrap" id="pin2">
                            <div class="pin-box"><input class="pin" inputmode="numeric" maxlength="1"
                                    aria-label="첫째 자리 확인"></div>
                            <div class="pin-box"><input class="pin" inputmode="numeric" maxlength="1"
                                    aria-label="둘째 자리 확인"></div>
                            <div class="pin-box"><input class="pin" inputmode="numeric" maxlength="1"
                                    aria-label="셋째 자리 확인"></div>
                            <div class="pin-box"><input class="pin" inputmode="numeric" maxlength="1"
                                    aria-label="넷째 자리 확인"></div>
                        </div>
                    </div>

                    <div class="field">
                        <div class="labelline">출금계좌 비밀번호</div>
                        <div class="soft-box">
                            <div class="pin-wrap" aria-disabled="true">
                                <div class="pin-box" style="background:#f3f4f6"></div>
                                <div class="pin-box" style="background:#f3f4f6"></div>
                                <div class="pin-box" style="background:#f3f4f6"></div>
                                <div class="pin-box" style="background:#f3f4f6"></div>
                            </div>
                            <div class="hint" style="margin-top:8px">이전 단계에서 입력된 비밀번호가 적용됩니다.</div>
                        </div>
                    </div>
                </section>

                <!-- 하단 확인 -->
                <section class="card">
                    <div class="center">
                        <!-- 물음표 아이콘 -->
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--red-600)"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10" />
                            <path d="M9.1 9a3 3 0 0 1 5.8 1c0 2-3 2-3 4" />
                            <path d="M12 17h.01" />
                        </svg>
                        <b>신규상품 개설을 신청하시겠습니까?</b>
                        <div class="desc">위 정보로 신규상품 개설 신청이 진행됩니다.</div>
                    </div>
                </section>
            </div>
        </section>

        <!-- 3) 내비게이션 -->
        <div class="wizard-nav">
            <!-- 취소: 항상 표시 -->
            <button id="cancelBtn" class="btn btn-white">취소</button>

            <!-- 오른쪽: 이전 / 다음 -->
            <div class="nav-right">
                <button id="prevBtn" class="btn btn-white">이전</button>
                <button id="nextBtn" class="btn btn-red">다음</button>
            </div>
        </div>

    </main>
    <footer>
        <div id="footer"></div>
    </footer>
    <div id="bnk-chatbot-container" style="position: fixed; right: 20px; bottom: 20px; z-index: 9999;">
        <div id="bnk-chatbot-slot"></div>
    </div>
</body>

</html>
<script src="../../static/js/product.js"></script>
<!-- 스탭퍼 스크립트 -->
<script>
    let currentStep = 1;                 // 1~5
    const totalSteps = 5;
    const state = {};                    // 모든 단계의 입력값을 여기에 저장(필요 시)

    const pages = [...document.querySelectorAll('.step-page')];
    const steps = [...document.querySelectorAll('#wizardSteps .step')];
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');

    /* 유효성 검사 훅: 단계별로 통과하면 true 반환 */
    const validators = {
        1() {
            // 예: 필수 입력 검증
            // const name = document.querySelector('#name').value.trim();
            // if(!name){ alert('성명을 입력하세요.'); return false; }
            return true;
        },
        2() {
            // 예: 모든 약관 체크 확인
            // const ok = [...document.querySelectorAll('[name="agree"]:checked')].length >= 3;
            // if(!ok){ alert('모든 약관에 동의해주세요.'); return false; }
            return true;
        },
        3() {
            // 예: 인증 완료 플래그 확인
            // if(!state.verified){ alert('본인인증을 완료하세요.'); return false; }
            return true;
        },
        4() { return true; },
        5() { return true; } // 제출 단계라면 서버 전송 등 처리
    };

    /* 화면 전환 */
    function showStep(n) {
        currentStep = n;
        pages.forEach((el, i) => el.hidden = (i !== n - 1));

        steps.forEach((li, i) => {
            li.classList.remove('active', 'done');
            li.removeAttribute('aria-current');
            if (i < n - 1) li.classList.add('done');
            if (i === n - 1) { li.classList.add('active'); li.setAttribute('aria-current', 'step'); }
        });

        // 이전 버튼: page1에서는 숨김, 그 외엔 표시
        prevBtn.hidden = (n === 1);

        nextBtn.textContent = (n === totalSteps) ? '신청' : '다음';
        // 스크롤 보정
        // pages[n-1].scrollIntoView({behavior:'smooth', block:'start'});
    }

    /* 다음/제출 */
    nextBtn.addEventListener('click', async () => {
        // 현재 단계 저장/검증
        if (!validators[currentStep]()) return;

        // 마지막이면 제출 동작
        if (currentStep === totalSteps) {
            // 예: 서버 제출 (fetch) or 확인 모달
            alert('제출했습니다!');
            return;
        }
        showStep(currentStep + 1);
    });

    // 취소: 모든 단계에서 항상 동작
    document.getElementById('cancelBtn').addEventListener('click', () => {
        const ok = confirm('작성을 취소하고 이전 화면으로 돌아갈까요?\n저장되지 않은 내용은 사라질 수 있어요.');
        if (!ok) return;

        // 원하는 취소 정책으로 변경 가능
        if (history.length > 1) history.back();
        else location.href = '/';   // 또는 원하는 경로
    });

    // 이전
    prevBtn.addEventListener('click', () => {
        if (currentStep > 1) showStep(currentStep - 1);
    });



    /* 스텝 클릭으로 점프 이동(선택) */
    steps.forEach((li, idx) => {
        li.style.cursor = 'pointer';
        li.addEventListener('click', () => {
            // 완료했거나 바로 이전까지만 허용 등 정책 가능
            if (idx + 1 <= currentStep || idx + 1 === currentStep + 1) showStep(idx + 1);
        });
    });

    showStep(1);
</script>
<!-- 약관 및 상품설명서 받기 스크립트 -->
<script>
    const radios = document.querySelectorAll('input[name="receive"]');
    const input = document.getElementById('contactInput');
    const help = document.getElementById('contact-help');
    const error = document.getElementById('contact-error');

    function switchMode(mode) {
        input.value = '';
        error.textContent = '';
        if (mode === 'sms') {
            input.type = 'tel';
            input.placeholder = "휴대폰 번호 (‘-’ 없이)";
            input.setAttribute('inputmode', 'numeric');
            input.setAttribute('autocomplete', 'tel');
            input.setAttribute('pattern', '^01[0-9]{8,9}$');
            help.textContent = "휴대폰 번호는 ‘-’ 없이 숫자만 입력해 주세요.";
        } else {
            input.type = 'email';
            input.placeholder = "이메일 주소";
            input.removeAttribute('inputmode');
            input.setAttribute('autocomplete', 'email');
            input.removeAttribute('pattern');
            help.textContent = "정확한 이메일 주소를 입력해 주세요.";
        }
    }
    radios.forEach(r => r.addEventListener('change', e => switchMode(e.target.value)));
    switchMode(document.querySelector('input[name="receive"]:checked').value);

    // 간단한 실시간 유효성 안내
    input.addEventListener('blur', () => {
        if (!input.value) { error.textContent = ''; return; }
        if (!input.checkValidity()) {
            error.textContent = (input.type === 'tel')
                ? '휴대폰 번호 형식이 올바르지 않습니다.'
                : '이메일 형식이 올바르지 않습니다.';
        } else {
            error.textContent = '';
        }
    });

    // 이 폼에서 엔터 제출 금지
    const termsForm = document.querySelector('.get-terms form');

    // 1) 기본 submit 자체 막기
    termsForm.addEventListener('submit', (e) => e.preventDefault());

    // 엔터 → 현재 포커스된 요소만 포커스 해제
    termsForm.addEventListener('keydown', (e) => {
        if ((e.key === 'Enter' || e.keyCode === 13) && !e.isComposing) {
            e.preventDefault();
            e.stopPropagation();
            const el = document.activeElement;
            if (el && typeof el.blur === 'function') el.blur();
        }
    });

    // (선택) 모바일 키보드 힌트만 ‘완료’로 바꾸기
    input.setAttribute('enterkeyhint', 'done');
</script>
<!-- 상품설명서 및 약관 다운로드 표시 스크립트 -->
<script>
    // 신규가입(2단계) 약관 다운로드 완료 표시
    (function initTermsDownload() {
        const section = document.querySelector('#page2 .accept-terms');
        if (!section) return;

        const titleWrap = section.querySelector('.terms-title');
        const items = [...section.querySelectorAll('.terms-list .terms-item')];
        const links = items.map(i => i.querySelector('a.icon-btn')).filter(Boolean);

        // 전역 state 재사용 (스텝 이동시 상태 유지)
        window.state = window.state || {};
        state.termsDownloaded = state.termsDownloaded || {};

        // 진행률 표시 (간단 텍스트)
        const progress = document.createElement('span');
        progress.setAttribute('aria-live', 'polite');
        progress.style.marginLeft = '8px';
        progress.style.fontSize = '12px';
        progress.style.color = '#6B7280';
        titleWrap.querySelector('h2')?.appendChild(progress);

        function updateProgress() {
            const done = links.filter(a => a.classList.contains('downloaded')).length;
            progress.textContent = `(${done}/${links.length} 완료)`;
        }

        function markDownloaded(a, key) {
            if (a.classList.contains('downloaded')) return;
            a.classList.add('downloaded');                // ← CSS 활용
            a.setAttribute('aria-label', (a.getAttribute('aria-label') || '다운로드') + ' - 완료');
            a.setAttribute('data-downloaded', 'true');
            state.termsDownloaded[key] = true;
            updateProgress();
        }

        // 초기 복원
        links.forEach((a, idx) => {
            const key = a.closest('.terms-item')?.querySelector('span')?.textContent?.trim() || `term-${idx + 1}`;
            if (state.termsDownloaded[key]) a.classList.add('downloaded');
        });
        updateProgress();

        // 이벤트 바인딩: 클릭, Enter, Space
        links.forEach((a, idx) => {
            const key = a.closest('.terms-item')?.querySelector('span')?.textContent?.trim() || `term-${idx + 1}`;

            a.addEventListener('click', () => markDownloaded(a, key));
            a.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ' || e.key === 'Spacebar') {
                    // a 요소는 기본 동작을 유지(다운로드), 완료만 표시
                    markDownloaded(a, key);
                }
            });
        });

        // (선택) 다음 단계로 넘어갈 때 모두 다운로드했는지 검증하고 싶다면 validators[2] 교체
        if (window.validators) {
            const original = validators[2] || (() => true);
            validators[2] = function () {
                // 기본 검증 통과 후 추가 체크
                const ok = links.every(a => a.classList.contains('downloaded'));
                if (!ok) {
                    alert('상품설명서 및 약관을 모두 다운로드(또는 열람)해 주세요.');
                    return false;
                }
                return original();
            };
        }
    })();
</script>
<!-- 4단계 정보입력 스크립트 -->
<script>
    // 숫자 포맷
    function formatNumber(v) {
        const n = String(v).replace(/[^\d]/g, '');
        if (!n) return '';
        return n.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    }
    function setCurrencyInput(el) {
        el.addEventListener('input', () => {
            const pos = el.selectionStart;
            const beforeLen = el.value.length;
            el.value = formatNumber(el.value);
            // best-effort caret keep
            const afterLen = el.value.length;
            el.selectionEnd = el.selectionStart = pos + (afterLen - beforeLen);
        });
    }
    setCurrencyInput(document.getElementById('firstAmt'));
    setCurrencyInput(document.getElementById('goal'));

    // 최초불입금액 칩 동작
    const amtInput = document.getElementById('firstAmt');
    document.getElementById('firstAmtChips').addEventListener('click', (e) => {
        const btn = e.target.closest('.Chip'); if (!btn) return;
        [...e.currentTarget.querySelectorAll('.Chip')].forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        const won = btn.getAttribute('data-won');
        if (won) {
            amtInput.value = formatNumber(won);
            amtInput.blur();
        } else {
            amtInput.focus();
            amtInput.select();
        }
    });

    // 계약기간 칩 동작
    const months = document.getElementById('termMonths');
    const termDate = document.getElementById('termDate');
    document.getElementById('termChips').addEventListener('click', (e) => {
        const chip = e.target.closest('.Chip'); if (!chip) return;
        [...e.currentTarget.querySelectorAll('.Chip')].forEach(c => c.classList.remove('active'));
        chip.classList.add('active');
        const m = chip.dataset.month;
        const isDate = chip.dataset.type === 'date';
        if (isDate) {
            months.style.display = 'none';
            termDate.style.display = 'block';
            termDate.focus();
        } else {
            months.style.display = 'block';
            termDate.style.display = 'none';
            months.value = m || months.value;
            months.focus();
        }
    });

    // 개월 범위 보정
    months.addEventListener('change', () => {
        let v = parseInt(months.value || 0, 10);
        if (isNaN(v)) v = 6;
        v = Math.max(6, Math.min(36, v));
        months.value = v;
    });
</script>
<!-- 5단계 pin 입력 스크립트 -->
<script>
    // PIN 유틸
    function isSequentialOrRepeat(str) {
        if (str.length < 4) return false;
        // 반복(1111 등)
        if (/^(\d)\1{3}$/.test(str)) return true;
        // 오름차순 연속 0123, 4567, 6789
        if ('0123456789'.includes(str)) return true;
        // 내림차순 연속 9876, 3210
        if ('9876543210'.includes(str)) return true;
        return false;
    }

    // eye 아이콘 SVG
    function eyeSVG(open) {
        return open
            ? '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12Z"/><circle cx="12" cy="12" r="3"/></svg>'
            : '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m2 2 20 20"/><path d="M10.58 10.58A3 3 0 0 0 12 15a3 3 0 0 0 2.42-4.42"/><path d="M16.88 16.88C15.6 17.6 14 18 12 18 5 18 1 12 1 12a20.3 20.3 0 0 1 6.21-5.31"/><path d="M17.94 6.06A10.9 10.9 0 0 1 23 12s-1.64 2.64-4.12 4.54"/></svg>';
    }

    // PIN 그룹 세팅: 비밀번호 마스킹 + 자동이동 + 붙여넣기, (옵션) 표시/숨김 토글
    function setupPin(groupId, onFilled, { withToggle = false } = {}) {
        const wrap = document.getElementById(groupId);
        const inputs = [...wrap.querySelectorAll('input.pin')];

        inputs.forEach(inp => {
            inp.maxLength = 1;
            inp.inputMode = 'numeric';
            inp.autocomplete = 'off';
            inp.pattern = '[0-9]*';
            inp.type = 'password';                    // 기본 마스킹
            inp.setAttribute('enterkeyhint', 'done');  // 모바일 Enter 라벨 "완료"
        });

        let showAll = false;    // 눈아이콘 전체 표시 상태
        let visible = -1;       // 마지막으로 입력된 칸(보이는 칸)

        const isFilled = () => inputs.every(i => i.value && i.value.length === 1);

        function applyMasking() {
            if (showAll) { inputs.forEach(i => i.type = 'text'); return; }
            inputs.forEach((i, idx) => i.type = (idx === visible ? 'text' : 'password'));
        }

        // 입력/키동작
        inputs.forEach((inp, idx) => {
            inp.addEventListener('input', e => {
                e.target.value = e.target.value.replace(/\D/g, '').slice(0, 1);
                if (e.target.value) {
                    visible = idx;          // 방금 입력한 칸만 보이기
                    applyMasking();

                    // 다음 칸으로 포커스 이동(이 시점엔 직전 칸 그대로 보임)
                    if (inputs[idx + 1]) inputs[idx + 1].focus();

                    // 모두 채워졌으면 콜백
                    const v = inputs.map(i => i.value).join('');
                    if (v.length === inputs.length) onFilled?.(v);
                }
            });

            inp.addEventListener('keydown', e => {
                // 백스페이스로 이전 칸으로 이동 시: 이전 칸만 보이기
                if (e.key === 'Backspace' && !inp.value && inputs[idx - 1]) {
                    inputs[idx - 1].focus();
                    visible = idx - 1;
                    applyMasking();
                }
                // 값이 있는데 숫자키 누르면 덮어쓰기
                if (/^\d$/.test(e.key) && inp.value) { inp.value = ''; }
            });

            // 포커스 이동만으로는 마스킹 변화 없음
            inp.addEventListener('focus', () => { /* no-op */ });

            // 그룹을 벗어나면 안전하게 모두 마스킹
            inp.addEventListener('blur', () => {
                setTimeout(() => {
                    if (!wrap.contains(document.activeElement) && !showAll) {
                        visible = -1; applyMasking();
                    }
                }, 0);
            });
        });

        // 🔸 Enter 처리: 4자리 다 찬 상태에서 Enter → 제출 막고 포커스 해제
        wrap.addEventListener('keydown', e => {
            if (e.key === 'Enter' && isFilled()) {
                e.preventDefault();
                e.stopPropagation();
                visible = -1;       // 모두 마스킹
                applyMasking();
                // 포커스 완전 해제
                const active = document.activeElement;
                if (wrap.contains(active)) active.blur();

                // (권장) 폼의 암묵적 제출도 한 번 더 차단
                const form = wrap.closest('form');
                if (form) {
                    const onceBlock = ev => { ev.preventDefault(); };
                    form.addEventListener('submit', onceBlock, { once: true });
                    // 0ms 뒤 자동 제거(이번 엔터로 인한 submit만 막음)
                    setTimeout(() => form.removeEventListener('submit', onceBlock), 0);
                }
            }
        });

        // 붙여넣기: 마지막 채워진 칸만 보이기
        wrap.addEventListener('paste', e => {
            const txt = (e.clipboardData.getData('text') || '').replace(/\D/g, '').slice(0, inputs.length);
            if (!txt) return;
            e.preventDefault();
            inputs.forEach((i, k) => i.value = txt[k] || '');
            visible = Math.min(txt.length, inputs.length) - 1;
            (inputs[visible] || inputs[0]).focus();
            applyMasking();
            if (txt.length === inputs.length) onFilled?.(txt);
        });

        // (옵션) 눈 아이콘 토글
        if (withToggle) {
            const btn = document.createElement('button');
            btn.type = 'button';
            btn.className = 'pin-toggle';
            btn.setAttribute('aria-pressed', 'false');

            // 초기: 전체 숨김(showAll=false) → 감긴 눈 아이콘
            btn.innerHTML = eyeSVG(false);
            wrap.after(btn);

            btn.addEventListener('click', () => {
                showAll = !showAll;
                btn.setAttribute('aria-pressed', showAll ? 'true' : 'false');

                btn.innerHTML = eyeSVG(showAll);

                applyMasking();
            });
        }

        // 초기 상태
        visible = -1; applyMasking();

        return () => inputs.map(i => i.value).join('');
    }

    // 1차 PIN
    const pin1Get = setupPin('pin1', (v) => {
        const hint = document.getElementById('pin1Hint');
        if (isSequentialOrRepeat(v)) {
            hint.textContent = '연속되거나 반복되는 숫자는 사용할 수 없습니다.';
            hint.classList.add('error');
        } else {
            hint.textContent = '사용 가능한 비밀번호입니다.';
            hint.classList.remove('error');
        }
    });

    // 확인 PIN
    const pin2Get = setupPin('pin2', () => {
        const v1 = pin1Get(), v2 = pin2Get();
        if (v1 && v2 && v1 !== v2) {
            alert('신규추진 비밀번호가 일치하지 않습니다.');
        }
    });
</script>